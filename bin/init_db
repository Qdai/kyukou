#!/usr/bin/env node

var BBPromise = require('bluebird');

var getConnection = require('../db');
var tasklogs = [];
tasklogs.push({
  name: 'task',
  log: 'initialized',
  elapsedTime: 0
});
tasklogs.push({
  name: 'twit_new',
  log: 'initialized',
  elapsedTime: 0
});
tasklogs.push({
  name: 'twit_tomorrow',
  log: 'initialized',
  elapsedTime: 0
});
tasklogs.push({
  name: 'delete',
  log: 'initialized',
  elapsedTime: 0
});

BBPromise.using(getConnection(), function (db) {
  var Tasklog = db.model('Tasklog');
  return BBPromise.all(tasklogs.map(function (tasklog) {
    return new BBPromise(function (resolve, reject) {
      new Tasklog(tasklog).save(function (err, tasklog) {
        if (!err) {
          resolve(tasklog);
        } else {
          reject(err);
        }
      });
    });
  }));
}).then(function () {
  console.log('msg: db init success');
}).catch(function (err) {
  console.log('err: ' + err.stack);
});
